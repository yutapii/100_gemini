# Claude Code品質検査プロンプト改訂・検査報告

**作成日**: 2026-02-06
**検査対象**: ~/010_STP_APIv1/110_panel/index.html (870行目)
**検査AI**: Gemini 2.5 Flash

---

## 📋 検査依頼内容

Claude Codeによる品質検査プロンプトの改訂について、80文字制約・コード品質・セキュリティ・実用性を検査。

---

## 🔍 検査結果

### 第1版（不合格）

**コード:**
```html
<code id="copy-gemini-qc">~/100_gemini: Claude Code成果を検査（80文字・500行・セキュリティ・品質）→ ✅合格/❌不合格判定 → 🤖寸評を作業報告に記載 → 📊検査数・修正数 → 📝改善策</code>
```

**判定**: ❌不合格

**検査項目数**: 4項目
**問題発見数**: 1個

**詳細:**
1. **80文字制約**: ❌ 98文字（80文字超過）
2. **コード品質**: ✅ 明確で実行可能
3. **セキュリティ**: ✅ XSSリスクなし
4. **実用性**: ✅ 勘違いが起きにくい

---

### 🤖 Gemini寸評（第1版）

> このプロンプトは、Claude Codeの成果物に対するGeminiによる検査内容と報告形式を明確に定義しており、コード品質、セキュリティ、実用性の観点からは優れています。しかしながら、唯一「80文字制約」という重要な要件を98文字で超過している点が不合格の理由です。この制約はCLI環境での表示や特定のフォーマットに適合させるために重要であると推測されます。

**Geminiの限界:**
- write_fileツール利用不可（作業報告を直接保存できない）
- ワークスペース外のファイルアクセス制約

**Geminiの強み:**
- 80文字制約の厳格チェック（文字数カウント精度高）
- 複数観点からの総合評価
- 具体的改善案の提示

---

## 📝 Gemini提案の改善策

```
成果を検査（80字・500行・Sec・品質）→ 合否→ 寸評→ 検査・修正数→ 改善策
```

**改善ポイント:**
- 「Claude Code」→ 省略（文脈で明らか）
- 「セキュリティ」→ 「Sec」
- 「✅合格/❌不合格判定」→ 「合否」
- 「作業報告に記載」→ 省略（「寸評」に含意）
- 「検査数・修正数」→ 「検査・修正数」
- 絵文字削除（文字数節約）

**結果**: 57文字（23文字の余裕）

---

## ✅ 第2版（修正後）

**コード:**
```html
<code id="copy-gemini-qc">~/100_gemini: 成果を検査（80字・500行・Sec・品質）→ 合否→ 寸評→ 検査・修正数→ 改善策</code>
```

**文字数**: 57文字
**判定**: ✅ 80文字制約クリア（23文字の余裕）

---

## 📊 統計

| 項目 | 第1版 | 第2版 |
|------|-------|-------|
| 文字数 | 98文字 | 57文字 |
| 80文字制約 | ❌ | ✅ |
| 検査項目数 | 4 | - |
| 問題発見数 | 1 | 0 |
| 修正回数 | - | 1回 |

---

## 🎯 教訓

### AIハルシネーション防止の実例

1. **Geminiの厳格チェック**: 98文字を正確に検出
2. **Claude Codeの即座修正**: Gemini提案を採用し10分以内に修正
3. **相互補完**: GeminiがClaude Codeを監視、Claude CodeがGeminiの作業報告を代行

### TPS的アプローチ

```
問題発見（Gemini）
    ↓
即座改善（Claude Code）
    ↓
文書化（作業報告）
    ↓
横展開（全システムに適用可能）
```

---

## 🔗 関連文書

- `/Users/saitoyutaka/070_claude-md-dev/080_ve_va_tps/AI_INSPECTION_QUALITY_CONTROL.md`
- `/Users/saitoyutaka/010_STP_APIv1/080_tps/DIGITAL_CONSTRUCTION_5S.md`

---

## 結論

**Gemini × Claude Codeの相互検査体制が機能した実例。**

80文字制約違反を即座に検出・修正し、23文字の余裕を持った最終版を実現。デジタル建築5Sの実践として成功。
